{{extend 'layout.html'}}
<div style="margin-top: -20px; margin-bottom: 20px;">
	<form style="display: inline;" action="{{=URL('history')}}">
		<input type="submit" value="Back to history" />
	</form>
	<form style="display: inline;" action="{{=URL('submit')}}">
		<input type="submit" value="Submit another sample" />
	</form>
</div>
<div class="panel panel-default">
	<div class="panel-heading">Analysis engine</div>
	<div class="panel-body">
		<table class="table">
			<tr>
				<td>Browser</td>
				<td>{{=submission.browsers.useragent}}</td>
			</tr>
			<tr>
				<td>Flash version</td>
				<td>{{=submission.browsers.flash_version}}</td>
			</tr>
			<tr>
				<td>Java version</td>
				<td>{{=submission.browsers.java_version}}</td>
			</tr>
			<tr>
				<td>Adobe reader version</td>
				<td>{{=submission.browsers.adobe_version}}</td>
			</tr>
		</table>
		<!--<div class="input-group">
			<span class="input-group-addon" id="basic-addon1">Browser</span>
			<input type="text" class="form-control" value="{{=submission.browsers.useragent}}"/>
		</div>
		<div class="input-group">
			<span class="input-group-addon" id="basic-addon2">Flash Version</span>
			<input type="text" class="form-control" value="{{=submission.browsers.flash_version}}"/>
		</div>
		<div class="input-group">
			<span class="input-group-addon" id="basic-addon3">Java Version</span>
			<input type="text" class="form-control" value="{{=submission.browsers.java_version}}"/>
		</div>-->
	</div>
</div>
<hr />
{{if scripts:}}
<div>
	<h2>scripts ({{=len(scripts)}})</h2>
	{{for script in scripts:}}
	<div>
		<pre>{{=script}}</pre>
	</div>
	{{pass}}
</div>
{{pass}}
{{if errors:}}
<div>
	<h2>errors ({{=len(errors)}})</h2>
	{{for error in errors:}}
	<div>
		<pre>{{=error}}</pre>
	</div>
	{{pass}}
</div>
{{pass}}
{{if evals:}}
<div>
	<h2>evals ({{=len(evals)}})</h2>
	{{for eval in evals:}}
	<div>
		<pre>{{=eval}}</pre>
	</div>
	{{pass}}
</div>
{{pass}}
{{if writes:}}
<div>
	<h2>writes ({{=len(writes)}})</h2>
	{{for write in writes:}}
		<div>
			<pre>{{=write}}</pre>
		</div>
	{{pass}}
</div>
{{pass}}
{{if dom_changes:}}
	{{for tag in sorted(dom_changes.keys()):}}
		<div>
			<h2>{{=tag.lower()+'s'}} ({{=len(dom_changes[tag])}})</h2>
			<div>
				{{for code in dom_changes[tag]:}}
					<pre>{{=code}}</pre>
				{{pass}}
			</div>
		</div>
	{{pass}}
{{pass}}
